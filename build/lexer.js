define(["jquery","id","tags"],function(a,b,c){function d(d){return _.map(d.split(/\{\{|\}\}/),function(d,e){if(e%2!==0){var f={temp:a.trim(d)},g={},h=f.temp.match(/\S+\(.*?\)|\S+=".*?"|\S+/g),i,j;f.name=h.shift();var k=f.name.match(/(.+?)\((.*?)\)/);if(i=f.name.match(/\/(.+)/))return f.isClosingTag=!0,f.name=i[1],f;if(j=f.name.match(/#(.+)/))return f.isId=!0,f.name=j[1],f.object=new b(f.name),f;k&&(f.name=k[1],g.param=k[2]),g.htmlAttributes="";var l;return _.each(h,function(a){var b;if(/#(.+)/.test(a))return l=a.match(/#(.+)/)[1];(b=a.match(/(.+?)\((.*?)\)/))?g[b[1]]=b[2]:/.+?".*?"/.test(a)?g.htmlAttributes+=" "+a:g[a]=!0}),f.object=new c.cache[f.name](g),l&&b.add(l,f.object),f}return d})}return d})