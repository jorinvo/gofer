define(["jquery","value","template","hook","tags"],function(a,b,c,d,e){function f(e){this.data=b(),f.subscribe(e,_.bind(this.data,this)),this.id=_.uniqueId("gofer"),d("dom",_.bind(function(){this.data.subscribe(_.bind(function(){a("."+this.id).html(this.content())},this))},this)),c("id",'<div class="<%= id %>"><%= content() %></div>')}function g(){}return _.extend(f.prototype,{edit:function(a){return a?this.content=function(){return _.reduce(this.data(),function(b,c){return b+a().replace(/\{\{el\}\}/,c)},"")}:this.content=function(){return _.reduce(this.data(),function(a,b){return a+b},"")},c("id",this)},view:function(a){return this.content()}}),f.cache={},f.subscribe=function(a,c){f.cache[a]?c(f.cache[a]()):f.cache[a]=b([]),f.cache[a].subscribe(c)},f.add=function(a,c){f.cache[a]||(f.cache[a]=b([]));var d=f.cache[a]().push(c.data())-1;c.data.subscribe(function(b){f.cache[a].update(d,b)})},_.extend(g.prototype,{edit:function(){return"{{el}}"},view:function(){return"{{el}}"}}),e.register({el:g}),f})